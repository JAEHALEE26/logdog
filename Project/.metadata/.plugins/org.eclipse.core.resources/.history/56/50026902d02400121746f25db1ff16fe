package logdog.Common.BackendWork;

import java.util.Map;
import java.util.Set;

import logdog.Common.BackendWork.DTO.BackendSettingData;

import com.google.appengine.api.taskqueue.Queue;
import com.google.appengine.api.taskqueue.QueueFactory;
import com.google.appengine.api.taskqueue.TaskOptions;
public class GAEBackendWorker implements BackendWorkingSet {

	public boolean CreateBackendWork(BackendSettingData BackendInfo)
	{
	  	Queue queue = QueueFactory.getQueue(BackendInfo.getPushQuereName());
	  	TaskOptions taskOptions = TaskOptions.Builder.withUrl(BackendInfo.getWorkURL());
	  	
	  	Map<String,String> sendData = BackendInfo.getSendData();
	  	Object[] Keylist= sendData.keySet().toArray();
	  	
	  	for(int i=0;i<sendData.size();i++)
	  	{
	  		taskOptions.param((String)Keylist[i].sendData.get(Keylist[i]));
	  	}
	  	
	  	                       
	  	queue.add(taskOptions);
		return true; 
		
	}
}
